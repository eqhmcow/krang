<tmpl_include header.tmpl>

<script language="javascript">

  function preview_story(id) {
        window.open("publisher.pl?rm=preview_story&story_id=" + id, "");
  }

  function remove(id) {
     if (confirm("Are you sure you wish to delete this item permanently?")) {
       document.krang_pager_form.rm.value = 'delete';
       document.krang_pager_form.id.value = id;
       document.krang_pager_form.submit();
     }
  }

  function checkout(id) {
    document.krang_pager_form.rm.value = 'goto_edit';
    document.krang_pager_form.id.value = id;
    document.krang_pager_form.submit();
  }

  function checkout_checked() {
       document.krang_pager_form.rm.value = 'checkout_checked';
       document.krang_pager_form.submit();
  }

  function move(id) {
    document.krang_pager_form.rm.value = 'move';
    document.krang_pager_form.id.value = id;
    document.krang_pager_form.submit();
  }

  function move_checked() {
       document.krang_pager_form.rm.value = 'move_checked';
       document.krang_pager_form.submit();
  }

  function edit(id) {
       document.krang_pager_form.rm.value = 'goto_edit';
       document.krang_pager_form.id.value = id;
       document.krang_pager_form.submit();
  }

  function view(id) {
       document.krang_pager_form.rm.value = 'goto_view';
       document.krang_pager_form.id.value = id;
       document.krang_pager_form.submit();
  }

  function log(id) {
       document.krang_pager_form.rm.value = 'goto_log';
       document.krang_pager_form.id.value = id;
       document.krang_pager_form.submit();
  }

</script>

<table border="0" cellpadding="2" cellspacing="0" width="100%">
<tr class="dark-bar">
  <td><tmpl_var desk_name> Desk</td>
  <td align="right"><a href="javascript:goto_help()">Help</a>&nbsp;</td>
</tr>
</table>

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr><td width="1" class="line"><img width="1" height="1"></td>
  <td><img width="1" height="4"><table border="0" cellpadding="5" cellspacing="0" width="100%"><tr class="light"><td valign="bottom">

<form name="krang_pager_form" method="POST">
  <input type="hidden" name="rm">
  <input type="hidden" name="id">
  <input type="hidden" name="desk_id" value="<tmpl_var desk_id>">

<tmpl_include HTMLPager/pager-internals.tmpl>

<tmpl_if krang_pager_rows>

  Sort By: &nbsp;&nbsp; <tmpl_var sort_select></td></tr>
</table>

<div class=button-bar>
  <input type="button" value="Move" onclick='move_checked()' class="button">
  <input type="button" value="Check Out" onclick='checkout_checked()' class="button">
  <input type="button" value="Publish" onclick='publish_checked()' class="button">
</div>


<table border="0" cellspacing="0" width="100%">
<tr><td class="no-border">Showing <tmpl_var start_row> to <tmpl_var end_row> of <tmpl_var found_count></td>
  <td align="right" class="no-border"><tmpl_var colhead_checkbox_column></td>
</table>

<table border="0" cellspacing="0" cellpadding="8" width="100%">
<tr><td>
<tmpl_loop krang_pager_rows>

<table cellspacing="0" width="100%" cellpadding="2">

<tr class="form-head">
    <td width="150"><b>Story</b> <tmpl_var story_id>
        v<tmpl_var version>&nbsp;&nbsp;&nbsp;
    </td>
    <td><tmpl_var title></td>
 <td align="right">
      <tmpl_var checkbox_column>
    </td>
  </tr></table>

  <table cellspacing="0" width="100%" class="form-cell">
       <tr>
          <td class="form-cell" width="120" style="border-bottom:none;">Type</td>
          <td class="form-cell" style="border-bottom:none;"><tmpl_var story_type></td>
       </tr>
     <tr>
        <td class="form-cell" width="120" style="border-top:none;">URL</td>
        <td class="form-cell" style="border-top:none;"><tmpl_var url></td>
        <tmpl_if thumbnail>
          <td width="50" align=center class="form-cell">
            <a href="javascript:preview_media(<tmpl_var id>)"><img src="<tmpl_var thumbnail>" border="0"></a>
          </td>
        </tmpl_if>
     </tr>
     <tr>
       <td colspan=<tmpl_if thumbnail>"3"<tmpl_else>"2"</tmpl_if> class="form-cell">
           <span style="float:right; font-weight: bold;"><tmpl_var command_column></span>
               <input type="button" value="Publish" onclick="publish('<tmpl_var id>')" class="button">
               <input type="button" value="Check Out" onclick="checkout('<tmpl_var id>')" class="button">
               <p>
               <input type="button" value="Move" onclick="move('<tmpl_var id>')" class="button"> to <select name="move_<tmpl_var id>"><tmpl_loop desk_loop><option value="<tmpl_var choice_desk_id>" <tmpl_if is_selected>SELECTED</tmpl_if>><tmpl_var choice_desk_name> Desk</tmpl_loop></select>
       </td>
     </tr>
  </table>

  <div style='height:15px'></div>

  </tmpl_loop>
<table cellspacing="0" width="100%" cellpadding="2">
<tr><td>
<tmpl_if prev_page_number><a href="javascript:go_page('<tmpl_var prev_page_number>')">&lt;&lt;</a></tmpl_if>

<tmpl_loop page_numbers>
  <tmpl_if is_current_page><b><tmpl_var page_number></b>
  <tmpl_else><a href="javascript:go_page('<tmpl_var page_number>')"><tmpl_var page_number></a>
  </tmpl_if>
  <tmpl_unless __last__>|</tmpl_unless>
</tmpl_loop>

<tmpl_if next_page_number><a href="javascript:go_page('<tmpl_var next_page_number>')">&gt;&gt;</a></tmpl_if>

  <tmpl_if show_big_view><a href="javascript:show_big_view('0')">show <tmpl_var user_page_size> per page</a>
  <tmpl_else><a href="javascript:show_big_view('1')">show 100 per page</a>
  </tmpl_if>

</td></tr></table>
</td></tr></table>
</td>
  <td width="1" class="line"><img width="1" height="1"></td>
</tr>
<tr><td colspan="3" class="line"><img width="1" height="1"></td></tr>
</table>

<div class="button-bar">
  <input type="button" value="Move" onclick='move_checked()' class="button">
  <input type="button" value="Check Out" onclick='checkout_checked()' class="button">
  <input type="button" value="Publish" onclick='publish_checked()' class="button">
</div>

</tmpl_if>

</form>

<tmpl_include footer.tmpl>
